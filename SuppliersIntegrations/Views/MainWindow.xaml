<Window x:Class="BOMVIEW.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:BOMVIEW"
        xmlns:controls="clr-namespace:BOMVIEW.Controls"
        Title="BOMVIEW v2.0.0 | 26.03.2025" Height="500" Width="1000"
        WindowState="Maximized"
        Background="#F5F7FA">

    <Window.Resources>
        <!-- Colors -->
        <Color x:Key="PrimaryColor">#3B82F6</Color>
        <Color x:Key="SecondaryColor">#6366F1</Color>
        <Color x:Key="AccentColor">#10B981</Color>
        <Color x:Key="WarningColor">#F59E0B</Color>
        <Color x:Key="ErrorColor">#EF4444</Color>
        <Color x:Key="LightGrayColor">#F3F4F6</Color>
        <Color x:Key="DarkGrayColor">#4B5563</Color>
        <Color x:Key="ExternalSupplierColor">#6366F1</Color>

        <!-- Brushes -->
        <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}"/>
        <SolidColorBrush x:Key="SecondaryBrush" Color="{StaticResource SecondaryColor}"/>
        <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}"/>
        <SolidColorBrush x:Key="WarningBrush" Color="{StaticResource WarningColor}"/>
        <SolidColorBrush x:Key="ErrorBrush" Color="{StaticResource ErrorColor}"/>
        <SolidColorBrush x:Key="LightGrayBrush" Color="{StaticResource LightGrayColor}"/>
        <SolidColorBrush x:Key="DarkGrayBrush" Color="{StaticResource DarkGrayColor}"/>
        <SolidColorBrush x:Key="BackgroundBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="DuplicateHighlightBrush" Color="#FFF9C4"/>
        <SolidColorBrush x:Key="ExternalSupplierBrush" Color="{StaticResource ExternalSupplierColor}"/>

        <!-- Keep existing converters -->

        <local:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <local:IntToVisibilityConverter x:Key="IntToVisibilityConverter"/>
        <local:SupplierToColorConverter x:Key="SupplierToColorConverter">
            <local:SupplierToColorConverter.DigiKeyBrush>
                <SolidColorBrush Color="#E3F2FD" Opacity="0.7"/>
            </local:SupplierToColorConverter.DigiKeyBrush>
            <local:SupplierToColorConverter.MouserBrush>
                <SolidColorBrush Color="#E8F5E9" Opacity="0.7"/>
            </local:SupplierToColorConverter.MouserBrush>
            <local:SupplierToColorConverter.FarnellBrush>
                <SolidColorBrush Color="#FFF3E0" Opacity="0.7"/>
            </local:SupplierToColorConverter.FarnellBrush>
            <local:SupplierToColorConverter.IsraelBrush>
                <SolidColorBrush Color="#E8EAF6" Opacity="0.7"/>
            </local:SupplierToColorConverter.IsraelBrush>
            <local:SupplierToColorConverter.DefaultBrush>
                <SolidColorBrush Color="Transparent"/>
            </local:SupplierToColorConverter.DefaultBrush>
            
            
        </local:SupplierToColorConverter>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2563EB"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1D4ED8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Icon Button Style -->
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="ToolTipService.ShowDuration" Value="3000"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#f3f4f6"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#e5e7eb"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Action Button Style -->
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#f3f4f6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Text Box Style -->
        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost" 
                                        Margin="{TemplateBinding Padding}"
                                        VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsFocused" Value="True">
                    <Setter Property="BorderBrush" Value="{StaticResource PrimaryBrush}"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Search Box Style -->
        <Style x:Key="SearchBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#F3F4F6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="32,10,12,10"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Width" Value="250"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="0">
                            <Grid>
                                <Path Data="{StaticResource IconSearch}"
                                      Width="18" Height="18"
                                      Stroke="#6B7280"
                                      StrokeThickness="1.5"
                                      Stretch="Uniform"
                                      HorizontalAlignment="Left"
                                      Margin="10,0,0,0"/>
                                <ScrollViewer x:Name="PART_ContentHost" 
                                              Margin="{TemplateBinding Padding}"
                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                            </Grid>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern DataGrid Style -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RowHeaderWidth" Value="0"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#E5E7EB"/>
            <Setter Property="VerticalGridLinesBrush" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#F9FAFB"/>
            <Setter Property="RowBackground" Value="White"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="RowHeight" Value="44"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
        </Style>

        <!-- DataGrid Column Header Style -->
        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="#374151"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,14"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#E5E7EB"/>
            <Setter Property="SeparatorBrush" Value="Transparent"/>
        </Style>

        <!-- DataGrid Cell Style -->
        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2563EB"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderThickness" Value="0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- DigiKey Column Style -->
        <Style x:Key="DigiKeyColumnStyle" TargetType="DataGridCell">
            <Setter Property="Background" Value="#E3F2FD"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding DigiKeyData.IsAvailable}" Value="False">
                    <Setter Property="Background" Value="#FFEBEE"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#1E40AF"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Mouser Column Style -->
        <Style x:Key="MouserColumnStyle" TargetType="DataGridCell">
            <Setter Property="Background" Value="#E8F5E9"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding MouserData.IsAvailable}" Value="False">
                    <Setter Property="Background" Value="#FFEBEE"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#166534"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Farnell Column Style -->
        <Style x:Key="FarnellColumnStyle" TargetType="DataGridCell">
            <Setter Property="Background" Value="#FFF3E0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding FarnellData.IsAvailable}" Value="False">
                    <Setter Property="Background" Value="#FFEBEE"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#9A3412"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Israel Column Style -->
        <Style x:Key="IsraelColumnStyle" TargetType="DataGridCell">
            <Setter Property="Background" Value="#E8EAF6"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsraelData.IsAvailable}" Value="False">
                    <Setter Property="Background" Value="#FFEBEE"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#3949AB"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Combined Row Style for duplicate/out-of-stock handling -->
        <Style x:Key="CombinedRowStyle" TargetType="DataGridRow">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="ToolTip" Value="{x:Null}"/>
            <Style.Triggers>
         
                <!-- External Supplier -->
                <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                    <Setter Property="Background" Value="{StaticResource ExternalSupplierBrush}"/>
                    <Setter Property="ToolTip" Value="This part uses an external supplier"/>
                </DataTrigger>


                <!-- Multiple conditions - duplicate and out of stock -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding DigiKeyData.IsAvailable}" Value="False"/>
                        <Condition Binding="{Binding MouserData.IsAvailable}" Value="False"/>
                        <Condition Binding="{Binding FarnellData.IsAvailable}" Value="False"/>
                        <Condition Binding="{Binding IsraelData.IsAvailable}" Value="False"/>
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="#FFEBEE"/>
                    <Setter Property="ToolTip" Value="Product out of stock at all suppliers"/>
                </MultiDataTrigger>

                <!-- Only duplicate -->
                <DataTrigger Binding="{Binding IsDuplicate}" Value="True">
                    <Setter Property="Background" Value="{StaticResource DuplicateHighlightBrush}"/>
                    <Setter Property="ToolTip" Value="Duplicate product found"/>
                </DataTrigger>
                <!-- Only out of stock -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding DigiKeyData.IsAvailable}" Value="False"/>
                        <Condition Binding="{Binding MouserData.IsAvailable}" Value="False"/>
                        <Condition Binding="{Binding IsraelData.IsAvailable}" Value="False"/>
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="#FFEBEE"/>
                </MultiDataTrigger>
            </Style.Triggers>
        </Style>


        <Style x:Key="ExternalSupplierCell" TargetType="DataGridCell">
            <Style.Triggers>
                <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                    <Setter Property="Background" Value="#E9D5FF"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <!-- User Entered Cell Style -->
        <Style x:Key="UserEnteredCellStyle" TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,4"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsUserEntered}" Value="True">
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Background" Value="#FFFDE7"/>
                    <Setter Property="ToolTip" Value="User entered data"/>
                </DataTrigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#2563EB"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderThickness" Value="0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Icons -->
        <PathGeometry x:Key="IconUpload">M3 17v3a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-3M16 6l-4-4-4 4M12 2v13</PathGeometry>
        <PathGeometry x:Key="IconSave">M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z M17 21v-8H7v8 M7 3v5h8</PathGeometry>
        <PathGeometry x:Key="IconPlus">M12 4v16m-8-8h16</PathGeometry>
        <PathGeometry x:Key="IconInventory">M19 11H5m14 4H5m6-8H5m14 12H9</PathGeometry>
        <PathGeometry x:Key="IconSearch">M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z</PathGeometry>
        <PathGeometry x:Key="IconHelp">M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z</PathGeometry>
        <PathGeometry x:Key="IconMail">M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z</PathGeometry>
        <PathGeometry x:Key="IconDuplicate">M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2</PathGeometry>
        <PathGeometry x:Key="IconWarning">M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z</PathGeometry>
        <local:StringIsNullOrEmptyConverter x:Key="StringIsNullOrEmptyConverter"/>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Top Bar -->
<Border Grid.Row="0" 
        Background="White" 
        Margin="16,16,16,8"
        CornerRadius="16"
        Padding="0">
    <Border.Effect>
        <DropShadowEffect Color="#000000" 
                BlurRadius="16" 
                ShadowDepth="2" 
                Opacity="0.08"/>
    </Border.Effect>

    <Grid>
        <!-- Top header with filename and primary actions -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Header -->
            <RowDefinition Height="Auto"/> <!-- Content - Search & Actions -->
        </Grid.RowDefinitions>
        
        <!-- Compact header with gradient background -->
                <Border Grid.Row="0" 
CornerRadius="16,16,0,0"
Padding="16,12"
Background="#F9FAFB"
BorderThickness="1"
BorderBrush="#E5E7EB">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <!-- File icon -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- File name -->
                            <ColumnDefinition Width="16"/>
                            <!-- Spacer -->
                            <ColumnDefinition Width="Auto"/>
                            <!-- Buttons -->
                            <ColumnDefinition Width="*"/>
                            <!-- Flexible space -->
                        </Grid.ColumnDefinitions>

                        <!-- Excel File Icon -->
                        <Border Grid.Column="0" 
Width="28" Height="28" 
Background="#217346" 
CornerRadius="7"
Margin="0,0,10,0" 
VerticalAlignment="Center">
                            <!-- Simple Excel "X" symbol -->
                            <TextBlock Text="X"
       FontWeight="Bold"
       FontSize="16"
       Foreground="White"
       HorizontalAlignment="Center"
       VerticalAlignment="Center"/>
                        </Border>
                        <!-- Filename -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="Current File" 
               FontSize="10" 
               Foreground="#6B7280" 
               Opacity="0.7"/>
                            <TextBlock x:Name="txtSelectedFile" 
               FontSize="14" 
               FontWeight="SemiBold" 
               Foreground="#111827"
               TextWrapping="NoWrap"/>
                        </StackPanel>

                        <!-- Buttons next to filename -->
                        <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center">
                            <!-- Upload BOM Button -->
                            <Button x:Name="btnSelectFile"
            Click="btnSelectFile_Click"
            Style="{StaticResource IconButton}"
            Margin="0,0,8,0"
            Padding="10,6"
            Height="38"
            ToolTip="Upload BOM file">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#F0F9FF" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                                        <Path Data="{StaticResource IconUpload}"
                                Width="16" Height="16"
                                Stroke="#0EA5E9"
                                StrokeThickness="1.5"
                                Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="Upload"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <!-- Export Button -->
                            <Button x:Name="btnSave"
            Click="btnSave_Click"
            Style="{StaticResource IconButton}"
            Margin="0,0,8,0"
            Padding="10,6"
            Height="38"
            ToolTip="Export to Excel">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#ECFDF5" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                                        <Path Data="{StaticResource IconSave}"
                                Width="16" Height="16"
                                Stroke="#10B981"
                                StrokeThickness="1.5"
                                Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="Export"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <Button x:Name="btnReconfigureMapping"
        Click="btnReconfigureMapping_Click"
        Style="{StaticResource IconButton}"
        Margin="0,0,8,0"
        Padding="10,6"
        Height="38"
        ToolTip="Reconfigure file mapping">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#F3F4F6" 
                Width="26" 
                Height="26" 
                CornerRadius="6">
                                        <Path Data="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37a1.724 1.724 0 0 0 2.572-1.065zM12 15.75a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5z"
                  Width="16" Height="16"
                  Fill="#4B5563"
                  Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="Reconfigure"
                   FontWeight="SemiBold"
                   FontSize="13"
                   Foreground="#111827"
                   Margin="8,0,0,0"
                   VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <!-- Toggle Button for Collapsing/Expanding -->
                            <Button x:Name="btnToggleButtons" 
Click="btnToggleButtons_Click"
Style="{StaticResource IconButton}"
Margin="0,0,0,0"
Padding="10,6"
Height="38"
ToolTip="Toggle action buttons visibility">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#F3F4F6" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                                        <Path x:Name="toggleIcon" 
                                Data="M19 9l-7 7-7-7" 
                                Width="12" 
                                Height="12"
                                Stroke="#4B5563"
                                StrokeThickness="1.5"
                                Stretch="Uniform"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                RenderTransformOrigin="0.5,0.5">
                                            <Path.RenderTransform>
                                                <RotateTransform x:Name="toggleIconRotation" Angle="0"/>
                                            </Path.RenderTransform>
                                        </Path>
                                    </Border>
                                    <TextBlock x:Name="toggleText" 
                               Text="Show Buttons" 
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                            
                            
                        </StackPanel>
                        
                        <!-- Exchange Rate Panel - Add this new panel in Column 4 (Flexible space) -->
                        <StackPanel Grid.Column="4" 
                                    Orientation="Horizontal" 
                                    HorizontalAlignment="Right" 
                                    VerticalAlignment="Center">
                            <Border Background="#ECFDF5" 
                                    Padding="12,8" 
                                    CornerRadius="8" 
                                    Margin="0,0,16,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="USD/ILS:" 
                                               FontWeight="SemiBold" 
                                               FontSize="13" 
                                               Foreground="#065F46" 
                                               VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtExchangeRate" 
                                               Text="3.60" 
                                               FontWeight="Bold" 
                                               FontSize="13" 
                                               Foreground="#059669" 
                                               Margin="6,0,0,0" 
                                               VerticalAlignment="Center"/>
                                    <TextBlock Text="₪" 
                                               FontWeight="SemiBold" 
                                               FontSize="13" 
                                               Foreground="#059669" 
                                               Margin="2,0,0,0" 
                                               VerticalAlignment="Center"/>
                                    <TextBlock x:Name="txtExchangeRateTimestamp" 
                                               Text="(refreshed)" 
                                               FontSize="10" 
                                               Foreground="#059669" 
                                               Margin="6,0,0,0" 
                                               VerticalAlignment="Center" 
                                               Opacity="0.8"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Border>
                <!-- Main content with search and collapsible action buttons -->
<Grid Grid.Row="1" Margin="16,12,16,12">
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/> <!-- Search row -->
        <RowDefinition Height="Auto"/> <!-- Toggle row -->
        <RowDefinition Height="Auto"/> <!-- Actions row -->
    </Grid.RowDefinitions>


   
    
  

    <!-- Collapsible Buttons Panel -->
    <Border Grid.Row="2" 
            x:Name="buttonsPanel"
            Background="#F9FAFB" 
            CornerRadius="10" 
            BorderThickness="1" 
            BorderBrush="#E5E7EB" 
            Padding="6">
        <WrapPanel Orientation="Horizontal">
            



                            <Border Grid.Row="0"
         Background="#F9FAFB" 
         CornerRadius="10"
         BorderThickness="1"
         BorderBrush="#E5E7EB"
         Height="36"
         Width="230"
                                    
         HorizontalAlignment="Left"
        Margin="4,0,4,0">
                                <Grid>
                                    <Path Data="{StaticResource IconSearch}"
               Width="16" Height="16"
               Stroke="#6B7280"
               StrokeThickness="1.5"
               Stretch="Uniform"
               HorizontalAlignment="Left"
               Margin="12,0,0,0"/>
                                    <TextBox x:Name="txtPartNumber"
                  TextChanged="txtPartNumber_TextChanged"
                  Background="Transparent"
                  BorderThickness="0"
                  Padding="36,0,12,0"
                  FontSize="13"
                  Height="36"
                  VerticalContentAlignment="Center"
                  ToolTip="Search by part number"
                  Foreground="#111827"/>
                                </Grid>
                            </Border>
            
                            <!-- Inventory Button -->
            <Button x:Name="btnManageInventory"
                    Click="btnManageInventory_Click"
                    Style="{StaticResource IconButton}"
                    Margin="2,0,4,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="Manage Inventory">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#EFF6FF" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <Path Data="{StaticResource IconInventory}"
                              Width="16" Height="16"
                              Stroke="#3B82F6"
                              StrokeThickness="1.5"
                              Stretch="Uniform"/>
                    </Border>
                    <TextBlock Text="Inventory"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <!-- Missing Products Button -->
            <Button x:Name="btnMissingProducts"
                    Click="ShowMissingProducts_Click"
                    Style="{StaticResource IconButton}"
                    Margin="4,0,4,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="View missing products">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#FEF2F2" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <Path Data="{StaticResource IconWarning}"
                              Width="16" Height="16"
                              Stroke="#EF4444"
                              StrokeThickness="1.5"
                              Stretch="Uniform"/>
                    </Border>
                    <TextBlock Text="Missing Parts"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

                            <!-- Add this button to the buttonsPanel in MainWindow.xaml, near other similar buttons -->

                            <Button x:Name="btnExternalSuppliers"
        Click="btnExternalSuppliers_Click"
        Style="{StaticResource IconButton}"
        Margin="4,0,4,0"
        Padding="10,6"
        Height="38"
        ToolTip="Manage External Suppliers">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#F5F3FF" 
                Width="26" 
                Height="26" 
                CornerRadius="6">
                                        <Path Data="M11.7 1.1732C11.8856 1.06603 12.1144 1.06603 12.3 1.17321L21.2263 6.3268C21.4119 6.43397 21.5263 6.63205 21.5263 6.84641V17.1536C21.5263 17.3679 21.4119 17.566 21.2263 17.6732L12.3 22.8268C12.1144 22.934 11.8856 22.934 11.7 22.8268L2.77372 17.6732C2.58808 17.566 2.47372 17.3679 2.47372 17.1536V6.84641C2.47372 6.63205 2.58808 6.43397 2.77372 6.32679L11.7 1.1732Z"
                  Width="16" Height="16"
                  Fill="#9333EA"
                  Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="External Suppliers"
                   FontWeight="SemiBold"
                   FontSize="13"
                   Foreground="#111827"
                   Margin="8,0,0,0"
                   VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <!-- Duplicates Button -->
            <Button x:Name="btnDuplicates"
                    Click="btnDuplicates_Click"
                    Style="{StaticResource IconButton}"
                    Margin="4,0,4,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="Manage duplicate products">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#FFFBEB" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <Path Data="{StaticResource IconDuplicate}"
                              Width="16" Height="16"
                              Stroke="#F59E0B"
                              StrokeThickness="1.5"
                              Stretch="Uniform"/>
                    </Border>
                    <TextBlock Text="Duplicates"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <!-- OpenBOM Button -->
            <Button x:Name="btnOpenBom"
                    Click="btnOpenBom_Click"
                    Style="{StaticResource IconButton}"
                    Margin="4,0,4,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="Connect to OpenBOM">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#F3F4F6" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <TextBlock Text="OB"
                                  FontWeight="Bold"
                                  FontSize="13"
                                  Foreground="#4B5563"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                    </Border>
                    <TextBlock Text="OpenBOM"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <!-- Add Product Button -->
            <Button x:Name="btnAddProduct"
                    Click="btnAddProduct_Click"
                    Style="{StaticResource IconButton}"
                    Margin="4,0,4,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="Add New Product">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#ECFDF5" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <Path Data="{StaticResource IconPlus}"
                              Width="16" Height="16"
                              Stroke="#10B981"
                              StrokeThickness="1.5"
                              Stretch="Uniform"/>
                    </Border>
                    <TextBlock Text="Add Product"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>

            <!-- Quick BOM Button -->
            <Button x:Name="btnQuickBom"
                    Click="btnQuickBom_Click"
                    Style="{StaticResource IconButton}"
                    Margin="4,0,2,0"
                    Padding="10,6"
                    Height="38"
                    ToolTip="Quick Load BOM">
                <StackPanel Orientation="Horizontal">
                    <Border Background="#F0F9FF" 
                            Width="26" 
                            Height="26" 
                            CornerRadius="6">
                        <Path Data="{StaticResource IconUpload}"
                              Width="16" Height="16"
                              Stroke="#0EA5E9"
                              StrokeThickness="1.5"
                              Stretch="Uniform"/>
                    </Border>
                    <TextBlock Text="Quick BOM"
                               FontWeight="SemiBold"
                               FontSize="13"
                               Foreground="#111827"
                               Margin="8,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>


                            <!-- Email Button -->
                            <Button x:Name="btnEmail"
        Click="btnEmail_Click"
        Style="{StaticResource IconButton}"
        Margin="4,0,4,0"
        Padding="10,6"
        Height="38"
        ToolTip="Send Email to support">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#EBF8FF" 
                Width="26" 
                Height="26" 
                CornerRadius="6">
                                        <Path Data="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"
                  Width="16" Height="16"
                  Stroke="#38B2AC"
                  StrokeThickness="1.5"
                  Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="support"
                   FontWeight="SemiBold"
                   FontSize="13"
                   Foreground="#111827"
                   Margin="8,0,0,0"
                   VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>

                            <!-- Help Button -->
                            <Button x:Name="btnHelp"
        Click="btnHelp_Click"
        Style="{StaticResource IconButton}"
        Margin="4,0,4,0"
        Padding="10,6"
        Height="38"
        ToolTip="View Help Guide">
                                <StackPanel Orientation="Horizontal">
                                    <Border Background="#F0FDF4" 
                Width="26" 
                Height="26" 
                CornerRadius="6">
                                        <Path Data="M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"
                  Width="16" Height="16"
                  Stroke="#10B981"
                  StrokeThickness="1.5"
                  Stretch="Uniform"/>
                                    </Border>
                                    <TextBlock Text="Help"
                   FontWeight="SemiBold"
                   FontSize="13"
                   Foreground="#111827"
                   Margin="8,0,0,0"
                   VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </WrapPanel>
    </Border>
</Grid>
    </Grid>
</Border>

        <!-- Quick BOM Popup -->
        <Popup x:Name="quickBomPopup" 
               PlacementTarget="{Binding ElementName=btnQuickBom}" 
               Placement="Bottom" 
               StaysOpen="False"
               AllowsTransparency="True">
            <Border Background="White" 
                    BorderBrush="#E0E0E0" 
                    BorderThickness="1" 
                    CornerRadius="12"
                    Padding="20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="16" 
                                      ShadowDepth="2" 
                                      Opacity="0.15"/>
                </Border.Effect>
                <StackPanel Width="300">
                    <TextBlock Text="Quick Load BOM" 
                               FontWeight="Bold"
                               FontSize="16"
                               Margin="0,0,0,16"/>

                    <TextBlock Text="Template" 
                               FontWeight="SemiBold"
                               Margin="0,0,0,6"/>
                    <ComboBox x:Name="cmbTemplates" 
                              Margin="0,0,0,16"
                              Height="40"
                              Padding="10,0">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" Padding="5,10"/>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>

                    <TextBlock Text="Assembly Quantity" 
                               FontWeight="SemiBold"
                               Margin="0,0,0,6"/>
                    <TextBox x:Name="txtAssemblyQty"
         Text="1"
         Margin="0,0,0,16"
         Height="40"
         Padding="12,0"
         VerticalContentAlignment="Center"
         PreviewTextInput="NumberValidationTextBox">
                        <TextBox.Template>
                            <ControlTemplate TargetType="TextBox">
                                <Border Background="White"
                    BorderBrush="#E5E7EB"
                    BorderThickness="1"
                    CornerRadius="8">
                                    <ScrollViewer x:Name="PART_ContentHost" 
                              Margin="{TemplateBinding Padding}"
                              VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </TextBox.Template>
                    </TextBox>

                    <CheckBox x:Name="QuickLoadBufferCheckbox"
                              Content="Add 10% quantity buffer (round up)"
                              IsChecked="True"
                              Margin="0,0,0,20"/>

                    <Button x:Name="btnSelectBomFile"
                            Click="btnSelectBomFile_Click"
                            Style="{StaticResource ModernButton}"
                            Height="44"
                            HorizontalContentAlignment="Center">
                        <StackPanel Orientation="Horizontal">
                            <Path Data="{StaticResource IconUpload}"
                                  Width="16"
                                  Height="16"
                                  Stroke="White"
                                  StrokeThickness="2"
                                  Stretch="Uniform"
                                  Margin="0,0,8,0"/>
                            <TextBlock Text="Select BOM File"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Border>
        </Popup>

        <!-- Main Content Area (DataGrid) -->
        <Border Grid.Row="1" 
                Background="White"
        Margin="16,16,16,8"
                CornerRadius="16"
                Padding="0">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                BlurRadius="16" 
                                ShadowDepth="1" 
                                Opacity="0.08"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- DataGrid -->
                <DataGrid x:Name="dgBomEntries" 
                         Grid.Row="0"
                         AutoGenerateColumns="False"
                         LoadingRow="DataGrid_LoadingRow"
                         SelectionChanged="dgBomEntries_SelectionChanged"
                         CellEditEnding="DgBomEntries_CellEditEnding"
                         CanUserAddRows="False"
                         CanUserDeleteRows="True"
                         IsReadOnly="False"
                         Margin="20,20,20,8"
                         RowStyle="{StaticResource CombinedRowStyle}">



                    <DataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Mark as External Supplier" Click="MenuItemMarkAsExternalSupplier_Click">
                                <MenuItem.Icon>
                                    <Path Data="M6,5C8.21,5 10,6.79 10,9C10,11.21 8.21,13 6,13C3.79,13 2,11.21 2,9C2,6.79 3.79,5 6,5M17,11.5V13H19V14.5H17V16H15.5V14.5H14V13H15.5V11.5H17M6,15C3,15 0,16.79 0,20V21H12V20C12,16.79 9,15 6,15Z"
                      Fill="#9333EA"
                      Width="16"
                      Height="16"
                      Stretch="Uniform"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <Separator/>
                            <MenuItem Header="Open in DigiKey" Click="MenuItemOpenInDigiKey_Click">
                                <MenuItem.Icon>
                                    <Path Data="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                      Fill="#1E88E5"
                      Width="16"
                      Height="16"
                      Stretch="Uniform"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Open in Mouser" Click="MenuItemOpenInMouser_Click">
                                <MenuItem.Icon>
                                    <Path Data="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                      Fill="#43A047"
                      Width="16"
                      Height="16"
                      Stretch="Uniform"/>
                                </MenuItem.Icon>
                            </MenuItem>
                            <MenuItem Header="Open in Farnell" Click="MenuItemOpenInFarnell_Click">
                                <MenuItem.Icon>
                                    <Path Data="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                      Fill="#FB8C00"
                      Width="16"
                      Height="16"
                      Stretch="Uniform"/>
                                </MenuItem.Icon>
                            </MenuItem>
                        </ContextMenu>
                    </DataGrid.ContextMenu>
                    <DataGrid.Columns>
                        <!-- Basic Information -->
                        <DataGridTextColumn Header="Item" 
                      Binding="{Binding Num}" 
                      Width="50"/>
                        <DataGridTextColumn Header="Ordering Code" 
              Binding="{Binding OrderingCode}" 
              Width="150"
              IsReadOnly="True">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource UserEnteredCellStyle}">
                                    <Setter Property="Background" Value="#FFF8E1"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="ToolTip" Value="This field is read-only"/>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Designator" 
                      Binding="{Binding Designator}" 
                      Width="120">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource UserEnteredCellStyle}"/>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Value" 
                      Binding="{Binding Value}" 
                      Width="100">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource UserEnteredCellStyle}"/>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="PCB Footprint" 
                      Binding="{Binding PcbFootprint}" 
                      Width="120">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource UserEnteredCellStyle}"/>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="QTY (1)" 
              Binding="{Binding QuantityForOne}" 
              Width="70"
              IsReadOnly="True">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource UserEnteredCellStyle}">
                                    <Setter Property="Background" Value="#FFF8E1"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="ToolTip" Value="This field is read-only"/>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="Total QTY" 
                      Binding="{Binding QuantityTotal}" 
                      Width="80"/>

                        <!-- DigiKey Data -->
                        <DataGridTextColumn Header="DK Order QTY" 
                      Binding="{Binding DigiKeyOrderQuantity}" 
                      Width="100">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource DigiKeyColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK Unit Price" 
                      Binding="{Binding DigiKeyUnitPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource DigiKeyColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK Total Price" 
                      Binding="{Binding DigiKeyCurrentTotalPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource DigiKeyColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK Stock" 
                      Binding="{Binding DigiKeyData.Availability}" 
                      Width="110">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource DigiKeyColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>

                        <!-- Israel Columns -->
                        <DataGridTextColumn Header="DK-IL Order QTY" 
                      Binding="{Binding IsraelOrderQuantity, UpdateSourceTrigger=PropertyChanged}" 
                      Width="110">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource IsraelColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK-IL Unit Price ($)" 
                      Binding="{Binding IsraelUnitPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource IsraelColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK-IL Total Price ($)" 
                      Binding="{Binding IsraelCurrentTotalPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource IsraelColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="DK-IL Stock" 
                      Binding="{Binding IsraelData.Availability}" 
                      Width="110">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource IsraelColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>

                        <!-- Mouser Data -->
                        <DataGridTextColumn Header="MS Order QTY" 
                      Binding="{Binding MouserOrderQuantity}" 
                      Width="100">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource MouserColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="MS Unit Price" 
                      Binding="{Binding MouserUnitPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource MouserColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="MS Total Price" 
                      Binding="{Binding MouserCurrentTotalPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource MouserColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="MS Stock" 
                      Binding="{Binding MouserData.Availability}" 
                      Width="110">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource MouserColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>

                        <!-- Farnell Data -->
                        <DataGridTextColumn Header="FR Order QTY" 
                      Binding="{Binding FarnellOrderQuantity}" 
                      Width="100">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource FarnellColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="FR Unit Price" 
                      Binding="{Binding FarnellUnitPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource FarnellColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="FR Total Price" 
                      Binding="{Binding FarnellCurrentTotalPrice, StringFormat=C5}" 
                      Width="130">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource FarnellColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                        <DataGridTextColumn Header="FR Stock" 
                      Binding="{Binding FarnellData.Availability}" 
                      Width="110">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell" 
                   BasedOn="{StaticResource FarnellColumnStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>

                        <!-- Best Supplier -->
                        <DataGridTextColumn Header="Best Supplier" 
                      Binding="{Binding BestCurrentSupplier}" 
                      Width="150">
                            <DataGridTextColumn.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Background">
                                        <Setter.Value>
                                            <Binding Path="BestCurrentSupplier" 
                           Converter="{StaticResource SupplierToColorConverter}"/>
                                        </Setter.Value>
                                    </Setter>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasExternalSupplier}" Value="True">
                                            <Setter Property="Background" Value="#E9D5FF"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                            <Setter Property="ToolTip" Value="External Supplier"/>
                                        </DataTrigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="#2563EB"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGridTextColumn.CellStyle>
                        </DataGridTextColumn>
                    </DataGrid.Columns>
                </DataGrid>

                <!-- Totals Panel -->
                <Border Grid.Row="1" 
                Background="{StaticResource LightGrayBrush}" 
                Margin="20,0,20,20" 
                Padding="10" 
                CornerRadius="12"
                Width="Auto"
                Height="Auto">
                    <Grid Width="Auto" Height="Auto">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="Summary" 
                           FontSize="16" 
                           FontWeight="Bold" 
                           Margin="0,0,0,12"/>



                        <WrapPanel Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 
                           Orientation="Horizontal">
                            <!-- DigiKey Totals -->
                            <Border Background="White" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="#E3F2FD" 
                            BorderThickness="2"
                            Width="220"
                            Height="125">
                                <StackPanel>
                                    <TextBlock Text="DigiKey" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="#1E88E5"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Unit Total:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Totals.DigiKeyUnitTotal, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Total Price:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Totals.DigiKeyTotalPrice, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Missing:" Margin="0,0,8,0"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Totals.DigiKeyMissingCount}" Foreground="{StaticResource ErrorBrush}" FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Mouser Totals -->
                            <Border Background="White" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="#E8F5E9" 
                            BorderThickness="2"
                            Width="220"
                            Height="125">
                                <StackPanel>
                                    <TextBlock Text="Mouser" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="#43A047"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Unit Total:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Totals.MouserUnitTotal, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Total Price:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Totals.MouserTotalPrice, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Missing:" Margin="0,0,8,0"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Totals.MouserMissingCount}" Foreground="{StaticResource ErrorBrush}" FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Farnell Totals -->
                            <Border Background="White" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="#FFF3E0" 
                            BorderThickness="2"
                            Width="220"
                            Height="125">
                                <StackPanel>
                                    <TextBlock Text="Farnell" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="#FB8C00"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Unit Total:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Totals.FarnellUnitTotal, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Total Price:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Totals.FarnellTotalPrice, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Missing:" Margin="0,0,8,0"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Totals.FarnellMissingCount}" Foreground="{StaticResource ErrorBrush}" FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Israel Totals -->
                            <Border Background="White" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="#E8EAF6" 
                            BorderThickness="2"
                            Width="220"
                            Height="125">
                                <StackPanel>
                                    <TextBlock Text="DigiKey Israel" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="#3949AB"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Unit Total:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Totals.IsraelUnitTotal, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Total Price:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Totals.IsraelTotalPrice, StringFormat=C2}" FontWeight="SemiBold"/>

                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Missing:" Margin="0,0,8,0"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding Totals.IsraelMissingCount}" Foreground="{StaticResource ErrorBrush}" FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Best Supplier Totals -->
                            <Border Background="White" 
                            CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="{StaticResource PrimaryBrush}" 
                            BorderThickness="2"
                            Width="220"
                            Height="125">
                                <StackPanel MinWidth="200">
                                    <TextBlock Text="Best Supplier" 
                                       FontWeight="Bold" 
                                       FontSize="14"
                                       Foreground="{StaticResource PrimaryBrush}"/>
                                    <Grid Margin="0,8,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>

                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Total Price:" Margin="0,0,8,4"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding Totals.BestSupplierTotal, StringFormat=C2}" FontWeight="Bold"/>

                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Missing:" Margin="0,0,8,0"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding Totals.BestSupplierMissingCount}" Foreground="{StaticResource ErrorBrush}" FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Border>


                            <!-- Duplicates Info Panel - Fixed size -->
                            <Border CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="{StaticResource WarningBrush}" 
                            BorderThickness="2"
                            MouseLeftButtonDown="DuplicatesSummaryPanel_Click"
                            Cursor="Hand"
                            Width="220"
                            Height="125">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="White"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#FFF8E6"/>
                                                <Setter Property="BorderThickness" Value="2.5"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <StackPanel>
                                    <TextBlock Text="Duplicates" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="{StaticResource WarningBrush}"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                        <TextBlock Text="Count:" Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding Totals.DuplicateCount}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <!-- Display duplicate ordering codes -->
                                    <ItemsControl x:Name="duplicateItemsControl" 
                                          MaxHeight="100" 
                                          Margin="0,8,0,0"
                                          ItemsSource="{Binding DuplicateOrderingCodes}">
                                        <ItemsControl.Template>
                                            <ControlTemplate>
                                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                                      HorizontalScrollBarVisibility="Disabled">
                                                    <ItemsPresenter />
                                                </ScrollViewer>
                                            </ControlTemplate>
                                        </ItemsControl.Template>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding}" 
                                                   Foreground="{StaticResource WarningBrush}"
                                                   FontSize="12"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,2,0,0"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>

                            <!-- Missing Parts Info Panel - Fixed size -->
                            <Border CornerRadius="8" 
                            Padding="16" 
                            Margin="0,0,16,8"
                            BorderBrush="{StaticResource ErrorBrush}" 
                            BorderThickness="2"
                            MouseLeftButtonDown="MissingPartsSummaryPanel_Click"
                            Cursor="Hand"
                            Width="220"
                            Height="125">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="White"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#FFEBEE"/>
                                                <Setter Property="BorderThickness" Value="2.5"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <StackPanel>
                                    <TextBlock Text="Missing Parts" 
                                       FontWeight="SemiBold" 
                                       FontSize="14"
                                       Foreground="{StaticResource ErrorBrush}"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                        <TextBlock Text="Count:" Margin="0,0,8,0"/>
                                        <TextBlock Text="{Binding Totals.BestSupplierMissingCount}" FontWeight="SemiBold"/>
                                    </StackPanel>
                                    <!-- Display missing part ordering codes -->
                                    <ItemsControl x:Name="missingPartsItemsControl" 
                                          MaxHeight="100" 
                                          Margin="0,8,0,0"
                                          ItemsSource="{Binding MissingPartOrderingCodes}">
                                        <ItemsControl.Template>
                                            <ControlTemplate>
                                                <ScrollViewer VerticalScrollBarVisibility="Auto"
                                                      HorizontalScrollBarVisibility="Disabled">
                                                    <ItemsPresenter />
                                                </ScrollViewer>
                                            </ControlTemplate>
                                        </ItemsControl.Template>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding}" 
                                                   Foreground="{StaticResource ErrorBrush}"
                                                   FontSize="12"
                                                   TextTrimming="CharacterEllipsis"
                                                   Margin="0,2,0,0"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </WrapPanel>
                    </Grid>
                </Border>



            </Grid>
        </Border>

        <!-- Loading Overlay -->
        <controls:LoadingOverlay x:Name="LoadingOverlay" 
                                Grid.RowSpan="2" 
                                Panel.ZIndex="1000"/>
    </Grid>
</Window>